DirectoryIndex cotizador.php index.php

<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    
    # Permitir acceso a archivos PHP existentes
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteCond %{REQUEST_FILENAME} \.(php)$
    RewriteRule ^ - [L]
    
    # Permitir acceso a directorios existentes
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [L]
    
    # Permitir acceso a archivos estáticos
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteCond %{REQUEST_FILENAME} \.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$
    RewriteRule ^ - [L]
    
    # Solo para rutas que NO son archivos o directorios existentes
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} !^/(cotizador|admin|health|test_|railway_|assets|uploads)
    RewriteRule ^(.*)$ index.php [L,QSA]
</IfModule>

# Configuración PHP
<IfModule mod_php.c>
    php_value display_errors Off
    php_value display_startup_errors Off
    php_value error_reporting E_ALL
</IfModule>

# Prevenir acceso directo a archivos sensibles
<Files "config.php">
    Order Allow,Deny
    Deny from all
</Files>

# Seguridad adicional
<Files ".env">
    Order Allow,Deny
    Deny from all
</Files>

# Headers de seguridad
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
</IfModule>

# Prevenir acceso directo a archivos del sistema
RewriteRule ^sistema/ - [F,L]

# Manejar errores
ErrorDocument 404 /index.php
ErrorDocument 500 /index.php